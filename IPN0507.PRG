SELECT 1
USE IPNHISTO INDEX IPNHISTO, IPNHIST2
SELECT 2
USE IPNOMINA INDEX IPNOMINA
SELECT 3
USE IPNPERSO INDEX IPNPERSO
DO WHILE .T.
   @ 04,0 clear
   @ 04,0 clear TO 16,60
   @ 05,1 say "RESUMEN DE CONCEPTOS BONIFICABLES"
   @ 08,5 SAY "NOMINA/CEDULA:"
   @ 10,5 SAY "DESDE        :"
   @ 12,5 SAY "HASTA        :"
   @ 14,5 SAY "SALIDA       :"
   STORE "INGRESE EL CODIGO DE LA NOMINA o <ENTER> PARA BUSQUEDA POR CEDULA" TO MES
   DO MENSAJE WITH MES
   STORE SPACE(5) TO WNOMINA
   @ 08,20 GET WNOMINA
   READ
   IF WNOMINA=SPACE(5)
      STORE "INGRESE CEDULA A PROCESAR o <ESC> PARA SALIR" TO MES
      DO MENSAJE WITH MES
      STORE SPACE(10) TO WCEDULA
      @ 08,20 GET WCEDULA
      READ
      IF READKEY()=12.OR.READKEY()=268
         EXIT
      ENDIF
      IF WCEDULA = SPACE(10)
         * SERAN PROCESADAS TODAS LAS PERSONAS DE TODAS LAS NOMINAS
      ELSE
         SELECT 3
         FIND &WCEDULA
         IF EOF()
            STORE "CEDULA NO REGISTRADA" TO MES
            DO AVISO WITH MES
            LOOP
         ELSE
            @ 08,30 SAY RTRIM(APELLIDO)+","+NOMBRE
         ENDIF
      ENDIF
   ELSE
      SELECT 2
      FIND &WNOMINA
      IF EOF()
         STORE "NOMINA NO REGISTRADA" TO MES
         DO AVISO WITH MES
         LOOP
      ELSE
         @ 08,30 SAY DESNOM
      ENDIF
   ENDIF
   STORE CTOD("  -  -    ") TO WDESDE
   STORE CTOD("  -  -    ") TO WHASTA
   @ 10,20 GET WDESDE
   READ
   IF WDESDE = CTOD("  -  -    ")
      LOOP
   ENDIF
   @ 12,20 GET WHASTA
   READ
   IF WHASTA = CTOD("  -  -    ")
      LOOP
   ENDIF
   IF WDESDE>WHASTA
      STORE "ERROR EN RANGO DE FECHAS" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   STORE SPACE(1) TO WMI
   DO WHILE WMI<>"M".AND.WMI<>"I"
      STORE "SALIDAS : (M)ONITOR, (I)MPRESORA" TO MES
      DO MENSAJE WITH MES
      @ 14,20 GET WMI PICTURE "!"
      READ
   ENDDO
   STORE "OPCIONES: (C)ONTINUAR, (S)ALIR" TO MES
   STORE "C" TO P1
   STORE "S" TO P2
   STORE " " TO RESP
   DO PIDE2 WITH P1,P2,MES,RESP
   IF RESP = "S"
      LOOP
   ENDIF
   STORE 0 TO WDIAD
   STORE 0 TO WDIADBS
   STORE 0 TO WDIAM
   STORE 0 TO WDIAMBS
   STORE 0 TO WDIAN
   STORE 0 TO WDIANBS
   STORE 0 TO WDESN
   STORE 0 TO WDESNBS
   STORE 0 TO WDESC
   STORE 0 TO WDESCBS
   STORE 0 TO WDESL
   STORE 0 TO WDESLBS
   STORE 0 TO WDESP
   STORE 0 TO WDESPBS
   STORE 0 TO WSTD
   STORE 0 TO WSTDBS
   STORE 0 TO WSTM
   STORE 0 TO WSTMBS
   STORE 0 TO WSTN
   STORE 0 TO WSTNBS
   STORE 0 TO WSTG
   STORE 0 TO WSTGBS
   STORE 0 TO WTVD
   STORE 0 TO WTVDBS
   STORE 0 TO WTVM
   STORE 0 TO WTVMBS
   STORE 0 TO WTVN
   STORE 0 TO WTVNBS
   STORE 0 TO WBNV
   STORE 0 TO WBNVBS
   STORE 0 TO WBNT
   STORE 0 TO WBNTBS
   STORE 0 TO WBNG
   STORE 0 TO WBNGBS
   STORE 0 TO WBC
   STORE 0 TO WBCBS
   STORE 0 TO WPRID
   STORE 0 TO WPRIDBS
   STORE 0 TO WPRIF
   STORE 0 TO WPRIFBS
   STORE 0 TO WAYUDA
   STORE 0 TO WAYUDABS
   STORE 0 TO WCOMIDA
   STORE 0 TO WCOMIDABS
   STORE 0 TO WREPOSO
   STORE 0 TO WREPOSOBS
   STORE 0 TO WFERIADO
   STORE 0 TO WFERIADOBS
   STORE 0 TO WOCBBS
   STORE 0 TO WBONTRABS
   STORE 0 TO WBONALIBS
   STORE 0 TO WCESTABS
   STORE 0 TO WVIVEBS
   STORE 0 TO WOCNBBS
   SELECT 1
   GO TOP
   DO WHILE .NOT. EOF()
      IF WNOMINA<>SPACE(5)
         IF NOMINA<>WNOMINA
            SELECT 1
            SKIP
            LOOP
         ENDIF
      ELSE
         IF CEDULA <> SPACE(10)
            IF CEDULA <> WCEDULA
               SELECT 1
               SKIP
               LOOP
            ENDIF
         ENDIF
      ENDIF
      IF FECHA>=WDESDE.AND.FECHA<=WHASTA
         STORE WDIAD+HRORDD             TO WDIAD
         STORE WDIADBS+BSORDD           TO WDIADBS
         STORE WDIAM+HRORDM             TO WDIAM
         STORE WDIAMBS+BSORDM           TO WDIAMBS
         STORE WDIAN+HRORDN             TO WDIAN
         STORE WDIANBS+BSORDN           TO WDIANBS
         STORE WDESN+HRDESNOR           TO WDESN
         STORE WDESNBS+BSDESNOR         TO WDESNBS
         STORE WDESC+HRDESCON           TO WDESC
         STORE WDESCBS+BSDESCON         TO WDESCBS
         STORE WDESL+HRDESLEG           TO WDESL
         STORE WDESLBS+BSDESLEG         TO WDESLBS
         STORE WDESP+HRDESCOM           TO WDESP
         STORE WDESPBS+BSDESCOM         TO WDESPBS
         STORE WSTD+HRSTDA+HRSTDB       TO WSTD
         STORE WSTDBS+BSSTDA+BSSTDB     TO WSTDBS
         STORE WSTM+HRSTMA+HRSTMB       TO WSTM
         STORE WSTMBS+BSSTMA+BSSTMB     TO WSTMBS
         STORE WSTN+HRSTNA+HRSTNB       TO WSTN
         STORE WSTNBS+BSSTNA+BSSTNB     TO WSTNBS
         STORE WSTG+HRSTGM+HRSTGN       TO WSTG
         STORE WSTGBS+BSSTGM+BSSTGN     TO WSTGBS
         STORE WTVD+HRTVDA+HRTVDB       TO WTVD
         STORE WTVDBS+BSTVDA+BSTVDB     TO WTVDBS
         STORE WTVM+HRTVMA+HRTVMB       TO WTVM
         STORE WTVMBS+BSTVMA+BSTVMB     TO WTVMBS
         STORE WTVN+HRTVNA+HRTVNB       TO WTVN
         STORE WTVNBS+BSTVNA+BSTVNB     TO WTVNBS
         STORE WBNV+HRBNV               TO WBNV
         STORE WBNVBS+BSBNV             TO WBNVBS
         STORE WBNT+HRBN                TO WBNT
         STORE WBNTBS+BSBN              TO WBNTBS
         STORE WBNG+HRBNG               TO WBNG
         STORE WBNGBS+BSBNG             TO WBNGBS
         STORE WBC+HRBONOCOM            TO WBC
         STORE WBCBS+BSBONOCOM          TO WBCBS
         STORE WPRID+HRBD               TO WPRID
         STORE WPRIDBS+BSBD             TO WPRIDBS
         STORE WPRIF+HRFERPRI           TO WPRIF
         STORE WPRIFBS+BSFERPRI         TO WPRIFBS
         STORE WAYUDA+HRAYUCIU          TO WAYUDA
         STORE WAYUDABS+BSAYUCIU        TO WAYUDABS
         STORE WCOMIDA+HRCOMIDA         TO WCOMIDA
         STORE WCOMIDABS+BSCOMIDA       TO WCOMIDABS
         STORE WREPOSO+HRREPCOM         TO WREPOSO
         STORE WREPOSOBS+BSREPCOM       TO WREPOSOBS
         STORE WFERIADO+HRFERIADO       TO WFERIADO
         STORE WFERIADOBS+BSFERIADO     TO WFERIADOBS
         STORE WOCBBS+BSOCB1+BSOCB2+BSOCB3 TO WOCBBS
         STORE WBONTRABS+BSBONOTRAN     TO WBONTRABS
         STORE WBONALIBS+BSBONOALIM     TO WBONALIBS
         STORE WCESTABS+BSCESTA         TO WCESTABS
         STORE WVIVEBS+BSVIVE           TO WVIVEBS
         STORE WOCNBBS+BSOCNB1+BSOCNB2  TO WOCNBBS
      ENDIF
      SELECT 1
      SKIP
   ENDDO
   IF WMI = "I"
      SET DEVI TO PRINT
      STORE 55 TO WSALTO
   ELSE
      SET DEVI TO SCRE
      @ 0,0 CLEAR
      STORE 20 TO WSALTO
   ENDIF
   STORE 0   TO WPAGINA
   STORE 100 TO WLINE
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO ORDINARIO DIURNO             Hrs.   "+STR(WDIAD,9,2)+"    "+STR(WDIADBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO ORDINARIO MIXTO              Hrs.   "+STR(WDIAM,9,2)+"    "+STR(WDIAMBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO ORDINARIO NOCTURNO           Hrs.   "+STR(WDIAN,9,2)+"    "+STR(WDIANBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "DESCANSO NORMAL                     Hrs.   "+STR(WDESN,9,2)+"    "+STR(WDESNBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "DESCANSO CONTRACTUAL TRABAJADO      Hrs.   "+STR(WDESC,9,2)+"    "+STR(WDESCBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "DESCANSO LEGAL TRABAJADO            Hrs.   "+STR(WDESL,9,2)+"    "+STR(WDESLBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "DESCANSO COMPENSATORIO              Hrs.   "+STR(WDESP,9,2)+"    "+STR(WDESPBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "SOBRETIEMPO DIURNO                  Hrs.   "+STR(WSTD ,9,2)+"    "+STR(WSTDBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "SOBRETIEMPO MIXTO                   Hrs.   "+STR(WSTM ,9,2)+"    "+STR(WSTMBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "SOBRETIEMPO NOCTURNO                Hrs.   "+STR(WSTN ,9,2)+"    "+STR(WSTNBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "SOBRETIEMPO DE GUARDIA              Hrs.   "+STR(WSTG ,9,2)+"    "+STR(WSTGBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO DE VIAJE DIURNO              Hrs.   "+STR(WTVD ,9,2)+"    "+STR(WTVDBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO DE VIAJE MIXTO               Hrs.   "+STR(WTVM ,9,2)+"    "+STR(WTVMBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "TIEMPO DE VIAJE NOCTURNO            Hrs.   "+STR(WTVN ,9,2)+"    "+STR(WTVNBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "BONO NOCTURNO DE VIAJE              Hrs.   "+STR(WBNV ,9,2)+"    "+STR(WBNVBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "BONO NOCTURNO TRABAJADO             Hrs.   "+STR(WBNT ,9,2)+"    "+STR(WBNTBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "BONO NOCTURNO DE GUARDIA            Hrs.   "+STR(WBNG ,9,2)+"    "+STR(WBNGBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "BONO COMPENSATORIO                  Hrs.   "+STR(WBC  ,9,2)+"    "+STR(WBCBS  ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "PRIMA DOMINICAL                     Hrs.   "+STR(WPRID,9,2)+"    "+STR(WPRIDBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "PRIMA POR FERIADO TRABAJADO         Hrs.   "+STR(WPRIF,9,2)+"    "+STR(WPRIFBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "AYUDA DE CIUDAD                     Hrs.   "+STR(WAYUDA,9,2)+"    "+STR(WAYUDABS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "COMIDAS                             Hrs.   "+STR(WCOMIDA,9,2)+"    "+STR(WCOMIDABS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "REPOSO/COMIDA TRABAJADO             Hrs.   "+STR(WREPOSO,9,2)+"    "+STR(WREPOSOBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507
   @ WLINE,00 SAY "FERIADOS ORDINARIOS                 Hrs.   "+STR(WFERIADO,9,2)+"    "+STR(WFERIADOBS,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507


   @ WLINE,00 SAY "OTROS CONCEPTOS BONIFICABLES        Hrs.   "+STR(0       ,9,2)+"    "+STR(WOCBBS    ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   @ WLINE,00 SAY "BONO DE TRANSPORTE                  Hrs.   "+STR(0       ,9,2)+"    "+STR(WBONTRABS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   @ WLINE,00 SAY "BONO ALIMENTICIO                    Hrs.   "+STR(0       ,9,2)+"    "+STR(WBONALIBS ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   @ WLINE,00 SAY "CESTA BASICA                        Hrs.   "+STR(0       ,9,2)+"    "+STR(WCESTABS  ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   @ WLINE,00 SAY "VIVIENDA                            Hrs.   "+STR(0       ,9,2)+"    "+STR(WVIVEBS   ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   @ WLINE,00 SAY "OTROS CONCEPTOS NO BONIFICABLES     Hrs.   "+STR(0       ,9,2)+"    "+STR(WOCNBBS   ,12,2)
   STORE WLINE+1 TO WLINE
   DO JUMP0507

   IF WMI = "M"
      STORE "OPRIMA <ENTER> PARA CONTINUAR" TO MES
      DO AVISO WITH MES
   ELSE
      SET DEVI TO SCRE
      EJECT
   ENDIF
ENDDO
CLOSE DATA
CLOSE INDEX
RETURN
************
