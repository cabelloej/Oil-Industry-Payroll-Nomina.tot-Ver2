***************************************
* LIQUIDACION PEQUIVEN                 *
****************************************
IF WMOTIVO = "TERMINACION"
    STORE 1 TO FFPP
    STORE 1 TO FFCC
    STORE 1 TO FFAA
ELSE
    IF WMOTIVO = "RENUNCIA"
       STORE 1 TO FFPP
       STORE 1 TO FFCC
       STORE 1 TO FFAA
    ELSE
       STORE 2 TO FFPP
       STORE 2 TO FFCC
       STORE 2 TO FFAA
    ENDIF
ENDIF
IF WMES < 3
   SELECT 4
   USE IPNOMINA
   LOCATE FOR CODNOM = WNOMINA
   IF .NOT. FOUND()
      STORE "ERROR, LA NOMINA DE ESTA PERSONA NO ESTA REGISTRADA" TO MES
      DO AVISO WITH MES
      USE
      RETURN
   ENDIF
   STORE FACTCOD TO WFACTCOD
   STORE DESNOM TO WDESCRINOM
   SELECT 4
   USE IPNFACTO
   LOCATE FOR FACCOD = WFACTCOD
   IF .NOT. FOUND()
      STORE "ERROR, LOS FACTORES DE ESTA NOMINA NO ESTA REGISTRADOS" TO MES
      DO AVISO WITH MES
      USE
      RETURN
   ENDIF
   STORE F_AYUCIU TO WAYUCIU
   STORE F_COMIDA TO WCOMIDA

   STORE ((WSUELDO+WBONOCO)/F_HORASD)*F_TVA TO WTV

   STORE (WSUELDO+WAYUCIU+WCOMIDA+WTV+WBONOCO) TO Wbasicodia
   STORE WBASICODIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO WBASICODIA
   STORE ROUND(WBASICODIA,2) TO WBASICODIA

   STORE (WSUELDO+WBONOCO) TO EXAMEN
   STORE EXAMEN TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO EXAMEN
   STORE ROUND(EXAMEN,2) TO EXAMEN

   STORE WSUELDO+WBONOCO TO QXbasicodia
   STORE QXBASICODIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO QXBASICODIA
   STORE ROUND(QXBASICODIA,2) TO QXBASICODIA

   STORE QXbasicodia * .23  TO WPORDIA
   STORE WPORDIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO WPORDIA
   STORE ROUND(WPORDIA,2) TO WPORDIA

   STORE SPACE(35) TO QQWW
   DO INFORMA WITH QQWW
   IF QQWW <> T3
      CLOSE DATA
      CLOSE INDEX
      STORE "ERROR DE INSTALACION" TO MES
      DO AVISO WITH MES
      RETURN
   ENDIF

   store 0 to wnetovac
   SELECT 4
   USE IPNpequi
   GO TOP
   LOCATE FOR meses > wmes
   IF .NOT. FOUND()
      STORE "ERROR, NO ENCONTRE LOS MESES APROPIADOS APROPIADOS PARA LA LIQUIDACION" TO MES
      DO AVISO WITH MES
      CLOSE DATA
      CLOSE INDEX
      RETURN
   ENDIF
   GO RECNO()-1
   STORE PREAVISO TO QQPREAVISO
   STORE VACACION TO QQVACACION
   STORE INDENCOM TO QQINDENCOM
   store bonovac to wnetovac
   IF IPNPERSO->VACACION <> CTOD("  -  -    ") .AND. IPNPERSO->VACACION > IPNPERSO->INGRESO
      **** BUSQUEDA DE LOS MESES DE VACACION A CANCELAR
      GO TOP
      LOCATE FOR meses > WmesVAC
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MESES DE VACACION APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      STORE VACACION TO QQVACACION
      STORE BONOVAC TO WNETOVAC
   ENDIF

   STORE WBASICODIA*QQPREAVISO TO BSPREAVISO
   STORE WBASICODIA*QQVACACION TO BSVACACION
   STORE QXBASICODIA*QQINDENCOM TO BSINDCOM
   STORE WPORDIA*WDIAS TO WTOTALLIQ

   STORE WTOTALLIQ TO BSMINIMO
   STORE WNETOVAC  TO BSBONOVAC
   STORE EXAMEN TO BSEXAMEN
   store BSMINIMO+BSBONOVAC+BSEXAMEN+BSPREAVISO+BSVACACION+BSINDCOM to wtotalpagar
      *********** CALCULO DEL MONTO ESCRITO
      STORE Wtotalpagar TO WMONTO
      STORE WTOTALPAGAR TO WNETO
      STORE INT(WMONTO/1000000) TO MILLONES
      STORE WMONTO-MILLONES*1000000 TO WMONTO
      STORE INT(WMONTO/1000) TO MILES
      STORE WMONTO-MILES*1000 TO WMONTO
      STORE INT(WMONTO/100) TO CIENTOS
      STORE WMONTO-CIENTOS*100 TO WMONTO
      STORE INT(WMONTO/10) TO DECENAS
      STORE WMONTO-DECENAS*10 TO WMONTO
      STORE INT(WMONTO/1) TO UNIDADES
      STORE WMONTO-UNIDADES*1 TO WMONTO
      STORE (WNETO-INT(WNETO))*100 TO CENTIMOS
      SELECT 9
      USE IPNMONTO
      store space(50) to escrito
      ***** MILLONES ******
      GO TOP
      LOCATE FOR VALOR > MILLONES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MILLONES APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      STORE MILLONES-VALOR TO RESTO
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LOS MILLONES APROPIADOS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" Y "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      IF MILLONES = 1
         STORE RTRIM(escrito)+" MILLON " TO escrito
      ELSE
         IF MILLONES > 1
            STORE RTRIM(escrito)+" MILLONES " TO escrito
         ENDIF
      ENDIF
      ***** MILES ******
      GO TOP
      LOCATE FOR VALOR > MILES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MILES APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      STORE MILES-VALOR TO RESTO
      IF MILES >= 100 .AND. MILES < 200 .AND. RESTO > 0
         STORE RTRIM(escrito)+"TO" TO escrito
      ENDIF
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LOS MILES APROPIADOS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      IF MILES > 0
         STORE RTRIM(escrito)+" MIL " TO escrito
      ENDIF

      ***** CIENTOS ****
      GO TOP
      LOCATE FOR VALOR > CIENTOS*100
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS CIENTOS APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      IF CIENTOS = 1 .AND. DECENAS*10+UNIDADES > 0
         STORE RTRIM(escrito)+"TO" TO escrito
      ENDIF

      ***** DECENAS ****
      IF DECENAS > 1
         GO TOP
         LOCATE FOR VALOR > DECENAS*10
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE LAS DECENAS APROPIADAS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         IF VALOR > 0
            STORE RTRIM(escrito)+" "+DES TO escrito
         ENDIF
      ELSE
         STORE DECENAS*10+UNIDADES TO UNIDADES
      ENDIF

      ***** UNIDADES ****
      GO TOP
      LOCATE FOR VALOR > UNIDADES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LAS UNIDADES APROPIADAS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" Y "+DES TO escrito
      ENDIF
      STOR UNIDADES-VALOR TO RESTO
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LAS UNIDADES APROPIADAS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" Y "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      STORE RTRIM(escrito)+" Bolivares con " TO escrito

      ***** CENTIMOS ****

      STORE RTRIM(escrito)+" "+LTRIM(RTRIM(STR(CENTIMOS,5)))+" CENTIMOS" TO escrito
      *********  FIN CALCULO MONTO ESCRITO   **********
   SET DEVI TO PRINT
   @ 0,28 SAY QQWW
   @ 2,13  SAY "FINIQUITO DE INDEMNIZACION POR TERMINACION DE CONTRATO"
   @ 4,35  SAY "LUGAR Y FECHA : "+RTRIM(QQWWDIR2)+" "+DTOC(WFECACT)
   @ 6,1   SAY "Yo, "+RTRIM(WNOMBRE)+" "+WAPELLIDO+" CŠdula de identidad No."+WCEDULA
   @ 8,1   SAY "Hago constar que he recibido de "+QQWW+", la suma de"
   @ 10,1  say "**"+chr(15)+escrito+chr(18)+" ** (Bs. "+str(wtotalpagar,9,2)+" )"
   @ 12,1  SAY "En car cter de Indemnizaci¢n por la terminaci¢n de mi contrato de ----"
   @ 14,1  say "trabajo con ella, en la obra: "+wdescrinom
   @ 16,1  say "seg£n la siguiente relaci¢n:"
   @ 18,1  say "MOTIVO POR EL CUAL TERMINO MI CONTRATO DE TRABAJO: "+WMOTIVO
   @ 19,26 SAY "Fecha de mi Empleo  Dia:"+STR(day(wingreso),2)+"   Mes:"+STR(month(wingreso),2)+"  A¤o:"+STR(year(wingreso),4)
   @ 21,26 SAY "Fecha de mi Retiro  Dia:"+STR(day(fechaliq),2)+"   Mes:"+STR(month(fechaliq),2)+"  A¤o:"+STR(year(fechaliq),4)
   @ 23,26 say "Tiempo de servicio   "+str(wmes,4)+" Meses y "+str(wdias,2)+" Dias"
   @ 25,1  say "SALARIO BASICO : Bs. "+STR(QXbasicodia,8,2)+" DIARIO x 0.23  = "+str(wpordia,7,2)
   @ 27,1  say "PREAVISO ART. 28 Y 29 LEY DEL TRABAJO "+STR(QQPREAVISO,3)+" x "+STR(WBASICODIA,10,2)+"   Bs."+STR(BSPREAVISO,11,2)
   @ 29,1  SAY "ANTIGUEDAD ART. 37 LEY DEL TRABAJO _____________________ Bs.-----------"
   @ 31,1  SAY "ANTIGUEDAD CLAUSULA ------- CONTRATO PETROLERO _________ Bs.-----------"
   @ 33,1  SAY "CESANTIA ART. 39 LEY DEL TRABAJO _______________________ Bs.-----------"
   @ 35,1  SAY "CESANTIA CLAUSULA --------- CONTRATO PETROLERO _________ Bs.-----------"
   @ 37,1  say "VACACIONES PARCIALES  LEY DEL TRABAJO "+STR(QQVACACION,3,2)+" x "+STR(WBASICODIA,10,2)+"   Bs."+STR(BSVACACION,11,2)
   @ 39,1  SAY "BONO VACACIONAL ---------------------------------------- Bs.  "+str(wnetovac,9,2)
   @ 41,1  SAY "INDEMNIZACION MINIMA Bs. "+str(wpordia,7,2)+" x "+str(wdias,7,2)+" dias -------- Bs. "+str(wtotalliq,10,2)
   @ 43,1  SAY "INDEMNIZACION COMPLEMENT."+str(QXBASICODIA,8,2)+" x "+str(QQINDENCOM,7,2)+" dias ------- Bs. "+str(BSINDCOM,10,2)
   @ 45,1  SAY "EXAMEN DE PRE-EMPLEO Y PRE-RETIRO _____ 1 dia __________ Bs.    "+str(examen,7,2)
   @ 47,1  SAY "TOTAL RECIBIDO EN ESTE ACTO ............................ Bs."+str(wtotalpagar,11,2)
   @ 49,1  SAY "OBSERVACIONES : _______________________________________________________"
   @ 51,1  SAY "_______________________________________________________________________"
   @ 53,1  SAY "TESTIGOS: _____________________________________________________________"
   @ 55,10 SAY "FIRMA DEL TRABAJADOR O A SU RUEGO POR DECIR NO SABER FIRMAR"
   @ 57,30 SAY "____________________"
   SET DEVI TO SCRE
   EJECT
ELSE
*****************   TRES MESES O MAS ***********************
   SELECT 4
   USE IPNOMINA
   LOCATE FOR CODNOM = WNOMINA
   IF .NOT. FOUND()
      STORE "ERROR, LA NOMINA DE ESTA PERSONA NO ESTA REGISTRADA" TO MES
      DO AVISO WITH MES
      USE
      RETURN
   ENDIF
   STORE FACTCOD TO WFACTCOD
   STORE DESNOM TO WDESCRINOM
   SELECT 4
   USE IPNFACTO
   LOCATE FOR FACCOD = WFACTCOD
   IF .NOT. FOUND()
      STORE "ERROR, LOS FACTORES DE ESTA NOMINA NO ESTA REGISTRADOS" TO MES
      DO AVISO WITH MES
      USE
      RETURN
   ENDIF
   STORE F_AYUCIU TO WAYUCIU
   STORE (WSUELDO+WBONOCO+WAYUCIU) TO Wbasicodia
   STORE WBASICODIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO WBASICODIA
   STORE ROUND(WBASICODIA,2) TO WBASICODIA

   STORE WSUELDO+WBONOCO TO QXbasicodia
   STORE QXBASICODIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO QXBASICODIA
   STORE ROUND(QXBASICODIA,2) TO QXBASICODIA

   STORE (WSUELDO+WBONOCO) TO EXAMEN
   STORE EXAMEN TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO EXAMEN
   STORE ROUND(EXAMEN,2) TO EXAMEN

   STORE SPACE(35) TO QQWW
   DO INFORMA   WITH QQWW
   IF QQWW <> T3
      CLOSE DATA
      CLOSE INDEX
      STORE "ERROR DE INSTALACION" TO MES
      DO AVISO WITH MES
      RETURN
   ENDIF

   store 0 to wnetovac
   SELECT 4
   USE IPNPEQUI
   GO TOP
   LOCATE FOR meses > xmes
   IF .NOT. FOUND()
      STORE "ERROR, NO ENCONTRE LOS MESES APROPIADOS" TO MES
      DO AVISO WITH MES
   ENDIF
   GO RECNO()-1
   STORE PREAVISO TO WTPREAVISO
   STORE ANTIGUEDAD TO WTANTIGUE
   STORE CESANTIA TO WTCESANTIA
   STORE VACACION TO WTVACACION
   STORE UTILIDAD TO WTUTILIDAD
   STORE TOTAL TO WTTOTAL
   STORE GARANTIA TO WTGARANTIA
   store bonovac to wnetovac
   STORE INDENADD TO WINDADD
   STORE INDENCOM TO WINDCOM
   STORE (BONOVAC/XMES)/30 TO WBONODIA

   IF IPNPERSO->VACACION <> CTOD("  -  -    ")
      **** BUSQUEDA DE LOS MESES DE VACACION A CANCELAR
      GO TOP
      LOCATE FOR meses > WmesVAC
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MESES DE VACACION APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      STORE VACACION TO WTVACACION
      STORE BONOVAC TO WNETOVAC
   ENDIF

   *********** BUSQUEDA DE HISTORICO ****************
   SELECT IPNHISTO
   SORT TO IPNTEMP2 ON FECHA /D FOR CEDULA = WCEDULA .AND. NOMINA <> "UTLDA" .AND. FECHA <= FECHALIQ .AND. NOMINA <> "LIQUI"
   SELECT 4
   USE IPNTEMP2
   PACK
   IF WTIPO = "E"
      STORE 2 TO BUSCAR
      STORE 30 TO DIVIDIR
   ELSE
      STORE 4 TO BUSCAR
      STORE 28 TO DIVIDIR
   ENDIF

   *******   CALCULO DEL TOTAL BONIFICABLE *************
   STORE 0 TO CONTEO
   STORE 0 TO ACUMULADO
   STORE 10 TO ZX
   DO WHILE .NOT. EOF() .AND. CONTEO < BUSCAR
      STORE ACUMULADO + BSTOTBON TO ACUMULADO
      STORE CONTEO +1 TO CONTEO
      SKIP
   ENDDO
   STORE ACUMULADO/DIVIDIR TO PROMEDIODIA
   STORE PROMEDIODIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO PROMEDIODIA
   STORE ROUND(PROMEDIODIA,2) TO PROMEDIODIA

   *** PREAVISO ***
   STORE WBASICODIA*WTPREAVISO*FFPP TO BSPREAVISO
   STORE BSPREAVISO TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO BSPREAVISO
   STORE ROUND(BSPREAVISO,2) TO BSPREAVISO

   *** ANTIGUEDAD ***
   STORE (PROMEDIODIA+IPNPERSO->SALPRO+WBONODIA)*WTANTIGUE*FFAA TO BSANTIGUE
   STORE BSANTIGUE TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO BSANTIGUE
   STORE ROUND(BSANTIGUE,2) TO BSANTIGUE

   *** CESANTIA ***
   STORE (PROMEDIODIA+IPNPERSO->SALPRO+WBONODIA)*WTCESANTIA*FFCC TO BSCESANTIA
   STORE BSCESANTIA TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO BSCESANTIA
   STORE ROUND(BSCESANTIA,2) TO BSCESANTIA

   *** VACACIONES ***
   STORE WBASICODIA*WTVACACION TO BSVACACION
   STORE BSVACACION TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO BSVACACION
   STORE ROUND(BSVACACION,2) TO BSVACACION

   *** BONO VACACIONAL ***
   STORE WNETOVAC TO BSBONOVAC
   STORE BSBONOVAC TO VARIABLE
   DO REDONDEO WITH VARIABLE
   STORE VARIABLE TO BSBONOVAC
   STORE ROUND(BSBONOVAC,2) TO BSBONOVAC

   *** EXAMEN ***
   STORE EXAMEN TO BSEXAMEN

   STORE 0 TO BSINDEN
   IF WINDADD > 0
      STORE " ADICIONAL     :" TO COMPLETA
      STORE PROMEDIODIA TO VVDIARIO
      STORE WINDADD TO VVDIAS
      STORE WINDADD*PROMEDIODIA TO BSINDEN
   ELSE
      IF WINDCOM > 0
         STORE " COMPLEMENTARIA:" TO COMPLETA
         STORE QXBASICODIA TO VVDIARIO
         STORE WINDCOM TO VVDIAS
         STORE WINDCOM*QXBASICODIA TO BSINDEN
      ELSE
         STORE "               " TO COMPLETA
         STORE 0 TO VVDIARIO
         STORE 0 TO VVDIAS
         STORE 0 TO BSINDEN
      ENDIF
   ENDIF

store BSPREAVISO+BSANTIGUE+BSCESANTIA+BSVACACION+BSBONOVAC+BSEXAMEN+BSINDEN TO WTOTALPAGAR
      *********** CALCULO DEL MONTO ESCRITO
      STORE Wtotalpagar TO WMONTO
      STORE WTOTALPAGAR TO WNETO
      STORE INT(WMONTO/1000000) TO MILLONES
      STORE WMONTO-MILLONES*1000000 TO WMONTO
      STORE INT(WMONTO/1000) TO MILES
      STORE WMONTO-MILES*1000 TO WMONTO
      STORE INT(WMONTO/100) TO CIENTOS
      STORE WMONTO-CIENTOS*100 TO WMONTO
      STORE INT(WMONTO/10) TO DECENAS
      STORE WMONTO-DECENAS*10 TO WMONTO
      STORE INT(WMONTO/1) TO UNIDADES
      STORE WMONTO-UNIDADES*1 TO WMONTO
      STORE (WNETO-INT(WNETO))*100 TO CENTIMOS
      SELECT 9
      USE IPNMONTO
      store space(50) to escrito
      ***** MILLONES ******
      GO TOP
      LOCATE FOR VALOR > MILLONES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MILLONES APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      STORE MILLONES-VALOR TO RESTO
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LOS MILLONES APROPIADOS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" Y "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      IF MILLONES = 1
         STORE RTRIM(escrito)+" MILLON " TO escrito
      ELSE
         IF MILLONES > 1
            STORE RTRIM(escrito)+" MILLONES " TO escrito
         ENDIF
      ENDIF
      ***** MILES ******
      GO TOP
      LOCATE FOR VALOR > MILES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS MILES APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      STORE MILES-VALOR TO RESTO
      IF MILES >= 100 .AND. MILES < 200 .AND. RESTO > 0
         STORE RTRIM(escrito)+"TO" TO escrito
      ENDIF
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LOS MILES APROPIADOS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      IF MILES > 0
         STORE RTRIM(escrito)+" MIL " TO escrito
      ENDIF

      ***** CIENTOS ****
      GO TOP
      LOCATE FOR VALOR > CIENTOS*100
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LOS CIENTOS APROPIADOS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" "+DES TO escrito
      ENDIF
      IF CIENTOS = 1 .AND. DECENAS*10+UNIDADES > 0
         STORE RTRIM(escrito)+"TO" TO escrito
      ENDIF

      ***** DECENAS ****
      IF DECENAS > 1
         GO TOP
         LOCATE FOR VALOR > DECENAS*10
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE LAS DECENAS APROPIADAS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         IF VALOR > 0
            STORE RTRIM(escrito)+" "+DES TO escrito
         ENDIF
      ELSE
         STORE DECENAS*10+UNIDADES TO UNIDADES
      ENDIF

      ***** UNIDADES ****
      GO TOP
      LOCATE FOR VALOR > UNIDADES
      IF .NOT. FOUND()
         STORE "ERROR, NO ENCONTRE LAS UNIDADES APROPIADAS" TO MES
         DO AVISO WITH MES
      ENDIF
      GO RECNO()-1
      IF VALOR > 0
         STORE RTRIM(escrito)+" Y "+DES TO escrito
      ENDIF
      STOR UNIDADES-VALOR TO RESTO
      STORE .T. TO CHECKREST
      DO WHILE CHECKREST
         GO TOP
         IF RESTO = 0
            STORE .F. TO CHECKREST
            LOOP
         ENDIF
         LOCATE FOR VALOR > RESTO
         IF .NOT. FOUND()
            STORE "ERROR, NO ENCONTRE EL RESTO DE LAS UNIDADES APROPIADAS" TO MES
            DO AVISO WITH MES
         ENDIF
         GO RECNO()-1
         STORE RTRIM(escrito)+" Y "+DES TO escrito
         STORE RESTO-VALOR TO RESTO
      ENDDO
      STORE RTRIM(escrito)+" Bolivares con " TO escrito

      ***** CENTIMOS ****

      STORE RTRIM(escrito)+" "+LTRIM(RTRIM(STR(CENTIMOS,5)))+" CENTIMOS" TO escrito
      *********  FIN CALCULO MONTO ESCRITO   **********

   SET DEVI TO PRINT
   @ 0,28 SAY QQWW
   @ 2,13  SAY "FINIQUITO DE INDEMNIZACION POR TERMINACION DE CONTRATO"
   @ 4,35  SAY "LUGAR Y FECHA : "+RTRIM(QQWWDIR2)+" "+DTOC(WFECACT)
   @ 6,1   SAY "Yo, "+RTRIM(WNOMBRE)+" "+WAPELLIDO+" CŠdula de identidad No."+WCEDULA
   @ 8,1   SAY "Hago constar que he recibido de "+QQWW+", la suma de"
   @ 10,1  say "**"+chr(15)+escrito+chr(18)+" ** (Bs. "+str(wtotalpagar,9,2)+" )"
   @ 12,1  SAY "En car cter de Indemnizaci¢n por la terminaci¢n de mi contrato de ----"
   @ 14,1  say "trabajo con ella, en la obra: "+wdescrinom
   @ 16,1  say "seg£n la siguiente relaci¢n:"
   @ 19,1  say "MOTIVO POR EL CUAL TERMINO MI CONTRATO DE TRABAJO: "+WMOTIVO
   @ 21,26 SAY "Fecha de mi Empleo  Dia:"+STR(day(wingreso),2)+"   Mes:"+STR(month(wingreso),2)+"  A¤o:"+STR(year(wingreso),4)
   @ 23,26 SAY "Fecha de mi Retiro  Dia:"+STR(day(fechaliq),2)+"   Mes:"+STR(month(fechaliq),2)+"  A¤o:"+STR(year(fechaliq),4)
   @ 25,26 say "Tiempo de servicio   "+str(wmes,4)+" Meses y "+str(wdias,2)+" Dias"
   @ 27,1  say "SALARIO BASICO : Bs. "+STR(Wbasicodia,8,2)+" DIARIO "
   @ 29,1  say "PREAVISO ART. 28 Y 29 LEY DEL TRABAJO: "+STR(WBASICODIA,8,2)+"x"+STR(WTPREAVISO,4)+"x"+STR(FFPP,1)+" Bs. "+STR(BSPREAVISO,10,2)
   @ 31,1  SAY "ANTIGUEDAD ART. 37 LEY DEL TRABAJO _____________________ Bs.-----------"
   @ 33,1  SAY "INDEMNIZACION DE ANTIGUE.: "+STR(ACUMULADO,10,2)+"/"+STR(DIVIDIR,2)+"x"+STR(WTANTIGUE,4)+"x"+STR(FFAA,1)+" ------ Bs. "+STR(BSANTIGUE,10,2)
   @ 35,1  SAY "CESANTIA ART. 39 LEY DEL TRABAJO _______________________ Bs.-----------"
   @ 37,1  SAY "APARTES ByC CLAUS.22,23,24:"+STR(ACUMULADO,10,2)+"/"+STR(DIVIDIR,2)+"x"+STR(WTCESANTIA,4)+"x"+STR(FFCC,1)+" ------ Bs. "+STR(BSCESANTIA,10,2)
   @ 39,1  say "VACACIONES PARCIALES ART.53 L.D.T.:"+STR(WBASICODIA,8,2)+" x "+STR(WTVACACION,5,1)+"----- Bs. "+STR(BSVACACION,10,2)
   @ 41,1  SAY "BONO VACACIONAL ---------------------------------------- Bs. "+str(BSBONOVAC,10,2)
   @ 43,1  SAY "INDEMNIZACION"+COMPLETA+STR(VVDIARIO,8,2)+"x"+STR(VVDIAS,8,2)+" --------- Bs.   "+STR(BSINDEN,8,2)
   @ 45,1  SAY "EXAMEN DE PRE-EMPLEO Y PRE-RETIRO _____ 1 dia __________ Bs.    "+str(examen,7,2)
   @ 47,1  SAY "TOTAL RECIBIDO EN ESTE ACTO ............................ Bs."+str(wtotalpagar,11,2)
   @ 49,1  SAY "OBSERVACIONES : _______________________________________________________"
   @ 51,1  SAY "_______________________________________________________________________"
   @ 53,1  SAY "TESTIGOS: _____________________________________________________________"
   @ 55,10 SAY "FIRMA DEL TRABAJADOR O A SU RUEGO POR DECIR NO SABER FIRMAR"
   @ 57,30 SAY "____________________"
   SET DEVI TO SCRE
   EJECT
ENDIF



   SELECT 2
   STORE WCEDULA+DTOC(FECHALIQ)+"LIQUI" TO WCLAVEHIST
   FIND &WCLAVEHIST
   IF EOF()
      APPEND BLANK
      REPLACE CEDULA WITH WCEDULA
      REPLACE FECHA WITH FECHALIQ
      REPLACE NOMINA WITH "LIQUI"
   ENDIF
   REPLACE ELABORADA WITH WFECACT
   REPLACE BASICO WITH BASICODIA

   REPLACE  MINIMO     WITH  BSMINIMO
   REPLACE  BONOVAC    WITH  BSBONOVAC
   REPLACE  EXAMEN     WITH  BSEXAMEN
   REPLACE  PREAVISO   WITH  BSPREAVISO
   REPLACE  ANTIGUE    WITH  BSANTIGUE
   REPLACE  CESANTIA   WITH  BSCESANTIA
   REPLACE  VACACION   WITH  BSVACACION
   REPLACE  INDCOM     WITH  BSINDCOM
RETURN

