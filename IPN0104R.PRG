SAVE SCRE TO WSCREIMP
@ 6,1 CLEAR TO 10,20
@ 6,1       TO 10,20
@ 6,4 SAY "VER PERSONAL"
@ 8,2 SAY "NOMINA:"
STORE SPACE(5) TO WNOMINA
@ 8,9 GET WNOMINA
READ
STORE "OPCIONES: (M)ONITOR, (I)MPRESORA, (S)ALIR" to mess
store "M" TO P1
STORE "I" TO P2
STORE "S" TO P3
STORE " " TO RESP
DO PIDE3 WITH P1, P2, P3, MESS, RESP
STORE "" TO WSALIDA
IF RESP = "M"
   STORE 20  TO WSALTO
   STORE "M" TO WSALIDA
   SET DEVI  TO SCRE
ELSE
   IF RESP = "I"
      STORE 55  TO WSALTO
      STORE "I" TO WSALIDA
      SET DEVI  TO PRINT
   ENDIF
ENDIF
*
IF RESP<>"S"
   STORE 100 TO WLINE
   STORE 0   TO WPAGE
   GO TOP
   DO WHILE .NOT. EOF()
      IF WNOMINA<>SPACE(5).AND.WNOMINA<>NOMINA
         SKIP
         LOOP
      ENDIF
      STORE WLINE+1 TO WLINE
      IF WLINE>=WSALTO
         DO HEADER
      ENDIF
      @ WLINE,00  SAY CEDULA
      @ WLINE,12  SAY APELLIDO
      @ WLINE,35  SAY NOMBRE
      @ WLINE,60  SAY TIPO
      @ WLINE,63  SAY TURNO
      @ WLINE,66  SAY NOMINA
      @ WLINE,73  SAY STR(SUELDO,7,2)
      SKIP
   ENDDO
ENDIF
IF WSALIDA="M"
   STORE "OPRIMA <ENTER> PARA FINALIZAR" TO MES
   DO AVISO WITH MES
ELSE
   IF WSALIDA = "I"
      EJECT
   ENDIF
ENDIF
SET DEVI TO SCRE
REST SCRE FROM WSCREIMP
RETURN
************
PROC HEADER
************
STORE WPAGE+1 TO WPAGE
IF WSALIDA="M"
   IF WPAGE>1
      STORE "OPRIMA <ENTER> PARA CONTINUAR" TO MES
      DO AVISO WITH MES
   ENDIF
   @ 0,0 CLEAR
ENDIF
IF LASTKEY()=27
   GO BOTT
ENDIF
@ 00,00 SAY QQWW
@ 00,60 SAY "FECHA  : "+DTOC(DATE())
@ 01,00 SAY "SISTEMA DE NOMINA"
@ 01,60 SAY "PAGINA : "+STR(WPAGE,2)
@ 02,00 SAY "LISTADO DE PERSONAL"
@ 04,00  SAY "CEDULA"
@ 04,12  SAY "APELLIDOS"
@ 04,35  SAY "NOMBRES"
@ 04,60  SAY "TP"
@ 04,63  SAY "TN"
@ 04,66  SAY "NOMINA"
@ 04,73  SAY "SUELDO"
@ 05,00  SAY "------------"
@ 05,12  SAY "------------------------"
@ 05,35  SAY "------------------------"
@ 05,60  SAY "--"
@ 05,63  SAY "--"
@ 05,66  SAY "------"
@ 05,73  SAY "------"
STORE 06 TO WLINE
RETURN
